{"version":3,"file":"renderers.js","sourceRoot":"","sources":["../../src/renderers.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  Circle,\n  ClipPath,\n  Defs,\n  Ellipse,\n  G,\n  Image,\n  Line,\n  LinearGradient,\n  Link,\n  Path,\n  Polygon,\n  Polyline,\n  RadialGradient,\n  Rect,\n  Stop,\n  Svg,\n  Text,\n  Tspan,\n  View,\n} from '@react-pdf/renderer';\nimport { HtmlRenderer, HtmlRenderers, WrapperRenderer } from './render.js';\nimport { HtmlElement } from './parse.js';\nimport { HtmlStyle } from './styles.js';\nimport { lowerAlpha, orderedAlpha, upperAlpha } from './ordered.type.js';\nimport { Style } from '@react-pdf/types';\nimport camelize from './camelize.js';\nimport { NodeType } from 'node-html-parser';\n\nexport const renderNoop: HtmlRenderer = ({ children }) => <></>;\n\nexport const renderPassThrough: React.FC<React.PropsWithChildren<any>> = ({\n  children,\n}) => children;\n\nconst convertSvgAttributes = (\n  attrs: Record<string, string>\n): Record<string, string> => {\n  const result: Record<string, string> = {};\n\n  for (const key in attrs) {\n    result[camelize(key)] = attrs[key];\n  }\n\n  return result;\n};\n\nconst convertSvgStyles = (stylesTags: Style[]): Style => {\n  return stylesTags.reduce((acc, cur) => ({ ...acc, ...cur }), {});\n};\n\nexport function toRoman(num: number) {\n  let result = '';\n  const conversationMap = new Map<number, string>([\n    [1000, 'M'],\n    [900, 'CM'],\n    [500, 'D'],\n    [400, 'CD'],\n    [100, 'C'],\n    [90, 'XC'],\n    [50, 'L'],\n    [40, 'XL'],\n    [10, 'X'],\n    [9, 'IX'],\n    [5, 'V'],\n    [4, 'IV'],\n    [1, 'I'],\n  ]);\n  conversationMap.forEach((roman, decimal) => {\n    let quotient: bigint = BigInt(num) / BigInt(decimal);\n    num = num % decimal;\n    while (quotient--) {\n      result += roman;\n    }\n  });\n  return result;\n}\n\nexport const renderSvgs: WrapperRenderer = (\n  Wrapper,\n  { element, style, children }\n) => {\n  return (\n    <Wrapper\n      {...convertSvgAttributes(element?.attributes)}\n      {...convertSvgStyles(style)}\n    >\n      {children}\n    </Wrapper>\n  );\n};\n\nexport const renderBlock: HtmlRenderer = ({ style, children }) => (\n  <View style={style}>{children}</View>\n);\n\nexport const renderInline: HtmlRenderer = ({ style, children }) => (\n  <Text style={style}>{children}</Text>\n);\n\nexport const childElements = (\n  element: HtmlElement,\n  tagNames?: string[]\n): HtmlElement[] =>\n  element.childNodes.filter(\n    (child) =>\n      child.nodeType === NodeType.ELEMENT_NODE &&\n      (!tagNames ||\n        tagNames.includes((child as HtmlElement).tagName.toLowerCase()))\n  ) as HtmlElement[];\n\nexport const getRows = (table: HtmlElement): HtmlElement[] => {\n  let rows = childElements(table, ['tr']);\n\n  const sections = childElements(table, ['tbody', 'thead']);\n  sections.forEach((section) => {\n    rows = rows.concat(childElements(section, ['tr']));\n  });\n  return rows;\n};\n\nexport const getMaxColumns = (table: HtmlElement) => {\n  if (!table) {\n    return 1;\n  }\n  let rows = getRows(table);\n\n  const colCounts = rows.map((row) => {\n    let colCount = 0;\n    childElements(row, ['td', 'th']).forEach((col) => {\n      const colspan = parseInt(col.attributes.colspan, 10);\n      if (isNaN(colspan)) {\n        colCount++;\n      } else {\n        colCount += colspan;\n      }\n    });\n    return colCount;\n  });\n\n  // const colCounts = rows.map((row) => childElements(row, ['td', 'th']).length);\n\n  return Math.max(1, ...colCounts);\n};\n\nexport const renderCell: HtmlRenderer = ({ style, element, children }) => {\n  const table = element.closest('table') as HtmlElement | undefined;\n  if (!table) {\n    throw new Error('td element rendered outside of a table');\n  }\n  const tableStyles = table.style.reduce(\n    (combined, tableStyle) => Object.assign(combined, tableStyle),\n    {} as HtmlStyle\n  );\n  const baseStyles: HtmlStyle = {\n    border: tableStyles.border,\n    borderColor: tableStyles.borderColor,\n    borderWidth: tableStyles.borderWidth,\n    borderStyle: tableStyles.borderStyle,\n  };\n  if (\n    (tableStyles as any).borderSpacing &&\n    (tableStyles as any).borderCollapse !== 'collapse'\n  ) {\n    baseStyles.width = tableStyles.borderWidth;\n    baseStyles.margin = (tableStyles as any).borderSpacing;\n  } else {\n    baseStyles.borderRightWidth = 0;\n    baseStyles.borderBottomWidth = 0;\n    if (element.indexOfType !== 0) {\n      baseStyles.borderLeftWidth = tableStyles.borderWidth;\n      baseStyles.borderTopWidth = tableStyles.borderWidth;\n    }\n  }\n\n  const colCount = getMaxColumns(table);\n  const basePercent = 100 / colCount;\n  baseStyles.width = basePercent.toFixed(5) + '%';\n\n  if (element.attributes && element.attributes.colspan) {\n    const colspan = parseInt(element.attributes.colspan, 10);\n    if (!isNaN(colspan)) {\n      baseStyles.width = (colspan * basePercent).toFixed(5) + '%';\n    }\n  }\n\n  return <View style={[baseStyles, ...style]}>{children}</View>;\n};\n\nconst renderers: HtmlRenderers = {\n  style: renderNoop,\n  script: renderNoop,\n  html: renderPassThrough,\n  li: ({ element, stylesheets, style, children }) => {\n    const bulletStyles = stylesheets.map((stylesheet) => stylesheet.li_bullet);\n    const contentStyles = stylesheets.map(\n      (stylesheet) => stylesheet.li_content\n    );\n    const list: HtmlElement = element.closest('ol, ul') as HtmlElement;\n    const ordered = list?.tag === 'ol' || element.parentNode.tag === 'ol';\n    const listStyle =\n      list?.style?.reduce(\n        (combined, listStyle) => Object.assign(combined, listStyle),\n        {} as HtmlStyle\n      ) || {};\n    const itemStyle = element.style.reduce(\n      (combined, itemStyle) => Object.assign(combined, itemStyle),\n      {} as HtmlStyle\n    );\n    const listStyleType =\n      itemStyle.listStyleType ||\n      itemStyle.listStyle ||\n      listStyle.listStyleType ||\n      listStyle.listStyle ||\n      '';\n\n    let bullet;\n    if (listStyleType.includes('none')) {\n      bullet = false;\n    } else if (listStyleType.includes('url(')) {\n      bullet = (\n        <Image\n          src={listStyleType.match(/\\((.*?)\\)/)[1].replace(/(['\"])/g, '')}\n        />\n      );\n    } else if (ordered) {\n      const currentIndex = element.indexOfType;\n      const start = parseInt(element.parentNode.attributes.start, 10);\n      const offset = isNaN(start) ? 0 : start - 1; // keep it zero based for later\n\n      let updatedIndex = currentIndex + offset;\n      let currentElement: HtmlElement | null = element;\n      let sibling: HtmlElement | null = currentElement;\n      do {\n        currentElement = sibling;\n        sibling = currentElement.previousElementSibling as HtmlElement | null;\n\n        if (!currentElement) {\n          break;\n        }\n        if (currentElement.tag !== 'li') {\n          // skip all other element types because they do not belong in a list\n          continue;\n        }\n        const startValue = parseInt(currentElement.attributes.value, 10);\n\n        if (!isNaN(startValue)) {\n          updatedIndex =\n            startValue + (currentIndex - currentElement.indexOfType) - 1;\n          break;\n        }\n      } while (!!sibling);\n\n      if (lowerAlpha.includes(listStyleType)) {\n        bullet = <Text>{orderedAlpha[updatedIndex].toLowerCase()}.</Text>;\n      } else if (upperAlpha.includes(listStyleType)) {\n        bullet = <Text>{orderedAlpha[updatedIndex].toUpperCase()}.</Text>;\n      } else if (listStyleType == 'lower-roman') {\n        bullet = <Text>{toRoman(element.indexOfType + 1).toLowerCase()}.</Text>;\n      } else if (listStyleType == 'upper-roman') {\n        bullet = <Text>{toRoman(element.indexOfType + 1).toUpperCase()}.</Text>;\n      } else {\n        bullet = <Text>{updatedIndex + 1}.</Text>;\n      }\n    } else {\n      // if (listStyleType.includes('square')) {\n      //   bullet = <Text>■</Text>;\n      // } else {\n      bullet = <Text>•</Text>;\n      // }\n    }\n\n    return (\n      <View style={style}>\n        {bullet && <View style={bulletStyles}>{bullet}</View>}\n        <View style={contentStyles}>{children}</View>\n      </View>\n    );\n  },\n  a: ({ style, element, children }) => (\n    <Link style={style} src={element.attributes.href}>\n      {children}\n    </Link>\n  ),\n  img: ({ style, element }) => (\n    <Image\n      style={style}\n      source={{\n        uri: element.attributes.src,\n        body: null,\n        method: 'GET',\n        headers: {\n          'Access-Control-Allow-Origin': '*',\n        },\n      }}\n    />\n  ),\n  table: ({ element, style, children }) => {\n    const tableStyles = element.style.reduce(\n      (combined, tableStyle) => Object.assign(combined, tableStyle),\n      {} as HtmlStyle\n    );\n    const overrides: HtmlStyle = {};\n    if (\n      !(tableStyles as any).borderSpacing ||\n      (tableStyles as any).borderCollapse === 'collapse'\n    ) {\n      overrides.borderLeftWidth = 0;\n      overrides.borderTopWidth = 0;\n    }\n\n    return <View style={[...style, overrides]}>{children}</View>;\n  },\n  tr: ({ style, children }) => (\n    <View wrap={false} style={style}>\n      {children}\n    </View>\n  ),\n  br: ({ style }) => (\n    <Text wrap={false} style={style}>\n      {'\\n'}\n    </Text>\n  ),\n  td: renderCell,\n  th: renderCell,\n  svg: renderSvgs.bind(null, Svg),\n  line: renderSvgs.bind(null, Line),\n  polyline: renderSvgs.bind(null, Polyline),\n  polygon: renderSvgs.bind(null, Polygon),\n  path: renderSvgs.bind(null, Path),\n  rect: renderSvgs.bind(null, Rect),\n  circle: renderSvgs.bind(null, Circle),\n  ellipse: renderSvgs.bind(null, Ellipse),\n  text: renderSvgs.bind(null, Text),\n  tspan: renderSvgs.bind(null, Tspan),\n  g: renderSvgs.bind(null, G),\n  stop: renderSvgs.bind(null, Stop),\n  defs: renderSvgs.bind(null, Defs),\n  clippath: renderSvgs.bind(null, ClipPath),\n  lineargradient: renderSvgs.bind(null, LinearGradient),\n  radialgradient: renderSvgs.bind(null, RadialGradient),\n};\n\nexport default renderers;\n"]}